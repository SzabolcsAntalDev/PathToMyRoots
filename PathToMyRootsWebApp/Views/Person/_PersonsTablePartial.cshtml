@using PathToMyRootsWebApp.Constants
@using PathToMyRootsWebApp.Utils
@model PathToMyRootsWebApp.Models.PersonsPageModel

<table id="persons-table"
       data-current-page="@Model.CurrentPage"
       data-total-pages="@Model.TotalPages">
    <thead>
        <tr>
            <th class="td-shrink"></th>
            <th>Noble Title</th>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Maiden Name</th>
            <th>Other Names</th>
            <th>Birth Date</th>
            <th>Death Date</th>
            <th>Mother</th>
            <th>Father</th>
            <th>Spouse</th>
            <th class="td-shrink"></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var person in Model.PersonModels)
        {
            <tr>
                <td class="td-shrink">
                    <img class="persons-img" src="https://localhost:7241/api/Image/get/@(person.ImageUrl ?? "missingImage.png")" />
                </td>
                <td>@person.NobleTitle</td>
                <td>@person.FirstName</td>
                <td>@person.LastName</td>
                <td>@person.MaidenName</td>
                <td>@person.OtherNames</td>
                <td>@DateHelper.ServerDateToHumanReadableDateFormat(person.BirthDate)</td>
                <td>@DateHelper.ServerDateToHumanReadableDateFormat(person.DeathDate)</td>
                <td>
                    @if (person.BiologicalMother == null)
                    {
                        <span>@PathToMyRootsWebAppConstants.UnknownValue</span>
                    }
                    else
                    {
                        <a asp-action="PersonDetails" asp-controller="Person" asp-route-id="@person.BiologicalMotherId">
                            @PersonModelFormatter.ToShortFullName(person.BiologicalMother)
                        </a>
                    }
                </td>
                <td>
                    @if (person.BiologicalFather == null)
                    {
                        <span>@PathToMyRootsWebAppConstants.UnknownValue</span>
                    }
                    else
                    {
                        <a asp-action="PersonDetails" asp-controller="Person" asp-route-id="@person.BiologicalFatherId">
                            @PersonModelFormatter.ToShortFullName(person.BiologicalFather)
                        </a>
                    }
                </td>
                <td>
                    @if (person.Spouse == null)
                    {
                        <span>@PathToMyRootsWebAppConstants.UnknownValue</span>
                    }
                    else
                    {
                        <a asp-action="PersonDetails" asp-controller="Person" asp-route-id="@person.SpouseId">
                            @PersonModelFormatter.ToShortFullName(person.Spouse)
                        </a>
                    }
                </td>

                <td class="td-shrink">
                    <div class="persons-div-actions">
                        <a asp-action="Tree" asp-controller="Tree" asp-route-id="@person.Id" class="persons-action-hyperlink">
                            <img src="~/icons/tree.svg" class="action-img" title="View Tree">
                        </a>
                        <a asp-action="EditPerson" asp-controller="Person" asp-route-id="@person.Id" class="persons-action-hyperlink">
                            <img src="~/icons/edit.svg" class="action-img" title="Edit">
                        </a>
                        <form asp-action="DeletePerson" asp-controller="Person" method="post" style="display: inline;">
                            <input type="hidden" name="id" value="@person.Id" />
                            <button type="submit" class="persons-action-button">
                                <img src="~/icons/delete.svg" class="action-img" title="Delete">
                            </button>
                        </form>
                    </div>
                </td>
            </tr>
        }
    </tbody>
</table>